import{attribute as a,beginBatch as d,endBatch as s}from"datastar";let o=[],i=new MutationObserver(t=>{t.forEach(r=>{if(!r.removedNodes.length)return;const n=Array.from(r.removedNodes??[]);o.forEach(e=>{n.includes(e.node)&&!document.body.contains(e.node)&&e.callback(r.target)})}),o=o.filter(r=>!r.isRemoved)});i.observe(document.body,{childList:!0,subtree:!0}),a({name:"on-remove",requirement:{key:"denied",value:"must"},argNames:["parent"],apply:({rx:t,el:r})=>{let n=e=>{d(),t(e),s()};return o.push({node:r,callback:n,isRemoved:!1}),()=>{o=o.map(e=>(e.node===r&&(e.isRemoved=!0),e))}}});
